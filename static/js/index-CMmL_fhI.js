import{_ as E}from"./index-BqNn1QRp.js";import{_}from"./index-ncGf53PB.js";import{_ as k}from"./index-m1hp8roE.js";import{d as T,e as N,i as a,w as l,a as y,o as x,y as r,j as m,g as d}from"./index-H_c7H9_6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";window.Notification&&window.Notification.permission!=="granted"&&window.Notification.requestPermission().then(t=>{if(t==="denied"){console.log("Permission wasn't granted. Allow a retry.");return}if(t==="default"){console.log("The permission request was dismissed.");return}});let u="";const g=["flash","scroll"],p={title:"iNotify !",body:"You have a new message.",openurl:""};function A(t,e){for(const o in e)t[o]&&(e[o]=t[o]);return e}function $(t){return Object.prototype.toString.call(t)==="[object Array]"}function F(t){const e=document.createElement("audio");e.autoplay=!0,e.muted=!0;let o;if($(t)&&t.length>0)for(let s=0;s<t.length;s++)o=document.createElement("source"),o.src=t[s],o.type=`audio/${B(t[s])}`,e.appendChild(o);else e.src=t;return e}function R(t){let e=document.querySelectorAll("link[rel~=shortcut]")[0];return e||(e=f("O",t)),e}function B(t){return t.match(/\.([^\\.]+)$/)[1]}function f(t,e){const o=document.createElement("canvas"),s=document.getElementsByTagName("head")[0],i=document.createElement("link");let n=null;return o.height=32,o.width=32,n=o.getContext("2d"),n.fillStyle=e.backgroundColor,n.fillRect(0,0,32,32),n.textAlign="center",n.font='22px "helvetica", sans-serif',n.fillStyle=e.textColor,t&&n.fillText(t,16,24),i.setAttribute("rel","shortcut icon"),i.setAttribute("type","image/x-icon"),i.setAttribute("id",`new${e.id}`),i.setAttribute("href",o.toDataURL("image/png")),u=o.toDataURL("image/png"),s.appendChild(i)}function w(t){t&&this.init(t)}w.prototype={init(t){return t||(t={}),this.interval=t.interval||100,this.effect=t.effect||"flash",this.title=t.title||document.title,this.message=t.message||this.title,this.onclick=t.onclick||this.onclick,this.openurl=t.openurl||this.openurl,this.disableFavicon=t.disableFavicon||!1,this.updateFavicon=!this.disableFavicon&&(t.updateFavicon||{id:"favicon",textColor:"#fff",backgroundColor:"#2F9A00"}),this.audio=t.audio||"",this.favicon=!this.disableFavicon&&R(this.updateFavicon),this.cloneFavicon=this.favicon&&this.favicon.cloneNode(!0),u=t.notification&&t.notification.icon?t.notification.icon:t.icon?t.icon:this.favicon.href,p.icon=u,this.notification=t.notification||p,this.audio&&this.audio.file&&this.setURL(this.audio.file),this},render(){if(this.effect==="flash")document.title=this.title===document.title?this.message:this.title;else if(this.effect==="scroll"){const t=this.message||document.title;!this.scrollTitle||!this.scrollTitle.slice(1)?(document.title=t,this.scrollTitle=t):(this.scrollTitle=this.scrollTitle.slice(1),document.title=this.scrollTitle)}return this},setTitle(t){if(t===!0){if(g.indexOf(this.effect)>=0)return this.addTimer()}else t?(this.message=t,this.scrollTitle="",this.addTimer()):this.clearTimer();return this},setURL(t){return t&&(this.audioElm&&this.audioElm.remove(),this.audioElm=F(t),document.body.appendChild(this.audioElm)),this},loopPlay(){return this.setURL(),this.audioElm.loop=!0,this.player(),this},stopPlay(){return this.audioElm&&(this.audioElm.loop=!1,this.audioElm.pause()),this},player(){if(!this.audio||!this.audio.file)return;this.audioElm||(this.audioElm=F(this.audio.file),document.body.appendChild(this.audioElm)),this.audioElm.muted=!1;const t=this.audioElm.play();return t!==void 0&&t.then(()=>{}).catch(()=>{}),this},notify(t){let e=this.notification;const o=t.openurl?t.openurl:this.openurl,s=t.onclick?t.onclick:this.onclick;if(window.Notification){t?e=A(t,e):e=p;const i={};i.icon=t.icon?t.icon:u,i.body=e.body||t.body,t.dir&&(i.dir=t.dir);const n=new Notification(e.title||t.title,i);n.onclick=()=>{s&&typeof s=="function"&&s(n),o&&window.open(o)},n.onshow=()=>{t.onshow&&typeof t.onshow=="function"&&t.onshow(n)},n.onclose=()=>{t.onclose&&typeof t.onclose=="function"&&t.onclose(n)},n.onerror=()=>{t.onerror&&typeof t.onerror=="function"&&t.onerror(n)},this.Notifiy=n}return this},isPermission(){return window.Notification&&Notification.permission==="granted"},setInterval(t){return t&&(this.interval=t,this.addTimer()),this},setFavicon(t){if(!t&&t!==0)return this.faviconClear();const e=document.getElementById(`new${this.updateFavicon.id}`);return this.favicon&&this.favicon.remove(),e&&e.remove(),this.updateFavicon.num=t,f(t,this.updateFavicon),this},setFaviconColor(t){return t&&(this.faviconRemove(),this.updateFavicon.textColor=t,f(this.updateFavicon.num,this.updateFavicon)),this},setFaviconBackgroundColor(t){return t&&(this.faviconRemove(),this.updateFavicon.backgroundColor=t,f(this.updateFavicon.num,this.updateFavicon)),this},faviconRemove(){this.faviconClear();const t=document.getElementById(`new${this.updateFavicon.id}`);this.favicon&&this.favicon.remove(),t&&t.remove()},addTimer(){return this.clearTimer(),g.indexOf(this.effect)>=0&&(this.timer=setInterval(this.render.bind(this),this.interval)),this},close(){this.Notifiy&&this.Notifiy.close()},faviconClear(){const t=document.getElementById(`new${this.updateFavicon.id}`),e=document.getElementsByTagName("head")[0],o=document.querySelectorAll("link[rel~=shortcut]");if(t&&t.remove(),o.length>0)for(let s=0;s<o.length;s++)o[s].remove();return e.appendChild(this.cloneFavicon),u=this.cloneFavicon.href,this.favicon=this.cloneFavicon,this},clearTimer(){return this.timer&&clearInterval(this.timer),document.title=this.title,this}};const I={class:"mb-2.5"},S=T({name:"PluginNotify"}),V=Object.assign(S,{setup(t){const e=()=>{window.open("https://github.com/jaywcjlove/iNotify","_blank")},o=new w({message:"有新消息~",effect:"flash",interval:1e3,disableFavicon:!1});return(s,i)=>{const n=y("el-tag"),b=k,c=y("el-button"),C=_,v=E;return x(),N("div",null,[a(C,{title:"通知"},{content:l(()=>[m("p",I,[i[5]||(i[5]=r("安装命令：")),a(n,null,{default:l(()=>i[4]||(i[4]=[r("pnpm i @wcjiang/notify")])),_:1})]),i[6]||(i[6]=m("p",null,"JS 实现浏览器标题闪烁，滚动，语音提示，Chrome/Safari/FireFox/IE 通知",-1))]),default:l(()=>[a(c,{type:"primary",onClick:e},{icon:l(()=>[a(b,{name:"ele-link"})]),default:l(()=>[i[7]||(i[7]=r(" 访问 @wcjiang/notify "))]),_:1})]),_:1}),a(v,{title:"Favicon 通知"},{default:l(()=>[i[10]||(i[10]=m("p",{class:"mb-2.5"},"注意看浏览器标题左侧的数字",-1)),a(c,{onClick:i[0]||(i[0]=h=>d(o).setFavicon(10))},{default:l(()=>i[8]||(i[8]=[r("设置 Favicon")])),_:1}),a(c,{onClick:i[1]||(i[1]=h=>d(o).faviconClear())},{default:l(()=>i[9]||(i[9]=[r("清空 Favicon")])),_:1})]),_:1}),a(v,{title:"标题通知"},{default:l(()=>[a(c,{onClick:i[2]||(i[2]=h=>d(o).setTitle(!0))},{default:l(()=>i[11]||(i[11]=[r("设置标题通知")])),_:1}),a(c,{onClick:i[3]||(i[3]=h=>d(o).setTitle(!1))},{default:l(()=>i[12]||(i[12]=[r("清空标题通知")])),_:1})]),_:1})])}}});export{V as default};
